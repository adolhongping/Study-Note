# Linux程序设计教程

## 第一章 基础概念知识

### 1、什么是**UNIX**?

**UNIX**操作系统最初是由贝尔实验室开发的，他现在已经成为非常流行的**多用户**、**多任务平台操作系统**。

**UNIX**是用Open Group（开放组织）管理的一个商标，它指的是以遵循特定规范的计算机操作系统。

### 2、UNIX操作系统的特点

简单性、集中性、可重用组件、过滤器、开放的文件格式、灵活性

### 3、什么是Linux

1. Linux是一个可以自由发布的类UNIX内核实现，他是一个操作系统的底层核心。
2. 由赫尔辛基大学的Linus Torvalds开发
3. 只要这个设备有处理器，就会有人试图让Linux在它上面运行

### 4、GNU项目

1. GNU:GNU‘s Not UNIX

2. GNU的通用许可证是GPL

3. #### GPL条款下发布的一些主要的GNU项目软件

   1. GCC:GNU编译器集，它包括GNU C编译器
   2. G++:C++编译器，是GCC的一部分
   3. GDB:源代码级的调试器
   4. GNU make:UNIX make命令的免费版本
   5. bash:命令解释器（shell）
   6. GNU Emacs:文本编辑器及环境
   7. Bison:与UNIX yacc兼容的语法分析程序生成器
   8. 更多自已软件下载地址：http://www.gnu.org

### 5、Linux程序

1. Linux程序表现为两种特殊的文件：

   1. 可执行文件：计算机可以直接运行的文件，他们相当于Widows中的.exe文件
   2. 脚本文件：一组命令的集合，这些指令将由另外一个程序来执行。相当于Windows中的.bat文件、.cmd文件或解释执行的BASIC文件。

2. 当登录Linux系统时，通常和一个shell程序（bash）进行交互

3. /bin：二进制文件目录，用于存放启动系统时用到的程序

4. 系统开发引导

   1. #### 应用程序

      1. 通常存放在系统为之保留的特定目录中，可在usr/bin中找到
      2. 对于系统级的应用程序，你可以将它放在/usr/local目录中来运行和访问所需的文件
      3. 对于开发用和个人用的应用程序，最好在家目录中使用一个 文件夹来存放

   2. #### **头文件**

      1. 用C语言或其他语言进行程序设计时，你需要使用头文件来提供对常量的定义和对系统函数级库函数的调用的声明

      2. 一般在/usr/include/sys和/usr/include/linux中找到

      3. 在调用C语言 编译器时，你可以使用-I来包含保存在子文件或者非标准位置中的头文件。

         `gcc -I/usr/openwin/include fred.c`

   3. #### **库函数**

      1. 库的定义：库是一组预先编译好的函数的集合，这些函数都是按照可重用的原则编写，通常由一组相互关联的函数组成以执行某项常见的任务。
      2. 标准系统库函数一般储存在/lib和/usr/lib目录中
      3. 库文件一般以lib开头
         - .a表示传统的静态库函数
         - .so代表共享函数库

   4. #### 静态库

      1. 函数库最简单的形式是一组处于“准备好使用”状态的目标文件，当系统需要使用函数库中的某个函数的时候，它包含一个声明该函数的头文件即可。编译器和链接器负责将程序代码和函数库结合在一起以组成一个单独的可执行文件（需使用-I指明除标准库外还需要使用的库）
      2. 静态库也成为归档文件

   5. #### 共享库

      1. 静态库的缺点：当同时运行许多应用程序并且他们都使用来自同一个函数库的函数时，内存中就会有同一个函数的多份副本，而且在程序文件自生中也有多份同样的副本。将消耗大量的资源。
      2. 对于共享库，当一个程序使用共享库时：程序本身本身不再包含代码，而是引用运行时可访问的共享代码。及运行时被加载。
## 第二章 shell程序设计

   ### 1、使用shell的好处

   1. 可以快速、简单的完成编程
   2. shell非常适合编写一些执行相对简单的任务的小工具，因为他们更强调的是易于配置、易于维护和可移植性、而不是很看重效率
   3. shell执行shell程序，这些程序通常被称为脚本，他们是在运行时解释执行的
   4. shell不适合用来完成时间紧迫型和处理器繁忙型的任务

   ### 2、什么是shell

   ​	shell是一个作为用户与Linux系统接口间的程序，它允许用户向操作系统输入需要执行的命令

   ​	**bash 版本查询**

   ​	`	/bin/bash -version`

   ### 3、管道和重定向

   #### 	3.1	重定向输出

   ​		`ls -1 > lsoutput.txt` 	把ls命令的输出保存到lsoutput.txt中

   ​		2、文件描述符	

   ​			0---程序的标准输入；1---标准输出；2---标准错误输出

   ​		3、>和>>的用法

   ​			> 把当前文件重定向到另一个文件

   ​			>> 把当前文件输出附加到目标文件尾部

   ​		4、`kill -1 1234  >killouterr.txt 2>&1`  

   ​				把标准输出和错误输出都重定向到同一个文件中

   #### 	3.2	管道

   ​		1、 什么是管道

   ​		管道操作符|连链接进程。在Linux下通过反官倒连接的进程可以同时运行，并且随着数据流他们之间的传递可以自动的进行协调

   ​		`ps |sort |more`

### 4、shell作为程序设计语言

​	1、编写shell脚本程序有两种方式

- 输入一系列命令让shell交互地执行他们
- 将他们（一些列命令）保存到一个文件中，然后将该文件作为一个程序来调用

​    2、shell支持通配符扩展

​		*：用于匹配一个字符串

​		？：用于匹配单个字符

​	\[set]:允许匹配方括号中的任何一个单个字符

​	\[^set]:取反匹配

​	3、shell脚本得意义

​		在执行一些重复得一系列命令时，每次都需要经过冗长得输入过程，可以把这些命令 保存得到一文件中，这一文件就叫做shell脚本，需要得时候可以随时执行它。

 4、shell脚本代码示例

  `#!/bin/sh`
  `# first`
  `# This file looks through all the files in the current`
  `# directory for the string POSIX,and then prints the name of`
  `# those files to the standard output` 
   `for file in *`
   `do`
   `if grep -q POSIX $file`
   `then`
    `echo $file`
  `fi`
  `done` 
  `exit 0`

  #!/bin/sh	#! 告诉系统同一行注释上紧跟在他后面得那个参数是用来执行本文件得程序（此处为shell）

  exit:	确保脚本程序能够返回一个有意义得退出码

5、把脚本文件设置为可执行文件

​	`chmod +x 文件名`

​	`./文件名`：用来执行该文件，./确保执行当前目录中得该文件，有效避免与可能存在得系统文件得冲突

 	Linux系统中，如果你拥有包含摸个文件得目录的写权限，就可以删除这个文件。

### 5、shell语法

#### 	5-1 变量

 		1、shell变量使用前不需要声明、通过使用他们来创建它

​		2、所有变量都被看做字符串以字符串来存储

​		3、需要数值型变量时，必要情况可以转换

​		4、Linux区分大小写，变量也区分大小写

​		5、访问变量内容：$salutation

​				`$salutation=hello`

​				`echo $salutation`

​				`hello`

​		6、如果字符串中有空格，就必须用引号把他们括起来。其次**等号两边不能有空格**

​		7、read命令将用户的输入赋值给一个变量 ，类似于scanf函数的作用

​		8、环境变量：当一个shell程序开始执行时，一些变量会根据环境设置中的值进行初始化，这些变量通常用大写字母做名字。具体参考环境变量参考书P101页

​		9、参数变量

​			脚本程序在调用时带有参数，一些额外的变量就会被创建。

​			即使没有传递任何参数，环境变量$#也依然存在，只不过他的值为0

​			环境变量用法，参考书P102页

#### 5-2 条件

​		一个shell脚本程序能够对任何可以从命令行上调用的命令的退出码进行测试，其中也包括你自己编写的脚本程序。

​		1、test|[命令

​		2、检查一个文件是否存在

​			`test -f <filename>`

​		3、条件语句结构	

​			`if  条件`

​			`then` ***

​			`else`  ***

​			`fi`

#### 5-3 控制结构

##### 	1、if语句

​		`if condition`

​		`then`

​			`statements`

​		`else`

​			`statements`

​		`fi`

##### 	**2、elif语句**

​	`if condition`

​		`then`

​			`statements` 

​		`elif condition; then`

​			`statements`

​		`else`

​			`statements`

  `fi`

##### 	3、for语句

​	`for variable in values`

​	`do`

​		`statements`

​	`done`	

##### 	4、while语句

​	需要重复执行一个命令时，但又不知道需要执行多少次时使用while

​	`while	condition  do`

​		`statements`

​	`done`

##### 	5、until

​	如果需要至少执行一次，使用while；如果根本并不需要执行循环，就是用until

​	`until condition`

​	`do`

​		`statements`

​	`done`

##### 	6、case语句

​	case结构具备匹配多个模式然后执行多条相关语句的能力，这使得它非常适合处理用户的输入

​	`case variable in`

​		`pattern [ | pattern ]  ...) statements;;`

​		`pattern [ | pattern ]  ...) statements;;`

​		`...`

​	`esac`

​	每条模式行都是以;;结尾，因为前后模式之间放多条语句，多以需要使用一个双分号来标记前一个语句的结束和后一个模式的开始

​	注意case语句中的通配符的使用，最好放在最后一条case语句中

​	最后一条case语句可以不加;;

##### 	7、AND和OR列表 测试点1

​	AND列表结构允许按照以下的方式执行一系列命令：只有在前面命令都执行成功的情况下才执行后一条语句。

​	**statements && statements && statements && ...**

​	OR列表结构允许执行一系列命令直到有一条命令成功执行为止，其后的命令不会被执行

​	**statements || statements || statements  ||  ...**

##### 	**8、语句块**

### 	6、函数

这是函数的测试